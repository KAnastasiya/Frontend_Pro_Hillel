!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var r=n(4),a=o(r),i=n(5),u=o(i),s=n(3),c=o(s),l=n(2),h=void 0,f=function(e,t){switch(e){case"human":return new a.default(t);case"orc":return new u.default(t);case"elf":return new c.default(t);default:console.error("It is impossible to create a fighter. Unknown race <"+e+">")}},p=function(e,t){switch(e.race){case"human":e.build();break;case"orc":e.attack(t);break;case"elf":e.shoot(t,(0,l.getRandomParam)(5,1),(0,l.getRandomParam)(100,1));break;default:console.error("It is impossible to make a move")}},d=function(e,t){return e.health>t.health?e:t},w=function(e,t,n,o){h=100;var r=f(e,t),a=f(n,o);if(r&&a)if(r.race!==a.race)if("human"!==r.race&&"human"!==a.race)console.error("Battle between "+r.race+" and "+a.race+" is impossible. One of the fighters must be a human");else for(console.warn("Battle started");h>0;)try{h%2?p(a,r):p(r,a),h-=1}catch(e){h=0,console.warn("Battle stopped. "+e.message);var i=d(a,r);console.warn(i.name+" ("+i.race+") is winner (his health = "+i.health+")!")}else console.error("Battle between two fighters of one race is impossible")};w("elf","Argon","human","Bob"),console.log("*******************************************"),w("human","Bony","orc","Bolg"),console.log("*******************************************"),w("orc","Bolg","elf","Argon"),console.log("*******************************************"),w("human","Alex","human","Nick"),console.log("*******************************************"),w("orc","Bolg","ninja","Katty")},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(2),i=function(){function e(t){o(this,e),this.health=100,this.power=50,this.damage=15,this.walkingSpeed=5,this.runningSpeed=15,this.name=t}return r(e,[{key:"walk",value:function(e){var t=(0,a.getTimeByDistanceAndSpeed)(e,this.walkingSpeed);console.log(this.name+" walk "+e+"km with speed "+this.walkingSpeed+"km/h (time - "+t+"h)")}},{key:"run",value:function(e){var t=(0,a.getTimeByDistanceAndSpeed)(e,this.runningSpeed);console.log(this.name+" run "+e+"km with speed "+this.runningSpeed+"km/h (time - "+t+"h)")}}]),e}();t.default=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRandomParam=function(e,t){var n=void 0;do n=Math.floor(Math.random()*(t-e)+e);while(!n);return n},t.getTimeByDistanceAndSpeed=function(e,t){return Math.floor(e/t)}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(1),c=o(s),l=10,h=5,f=.1,p=90,d=new WeakMap,w=function(e){function t(e){r(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.health=70,n.power=20,n.damage=40,d.set(n,l),n}return i(t,e),u(t,[{key:"shoot",value:function(e,t,n){if(0===this.arrowCount)throw new Error(this.name+" ("+this.race+") can not shoot more");if(this.arrowCount-t<0)return void console.error(this.name+" ("+this.race+") try to shoot "+t+" arrows, but can shoot only "+this.arrowCount+" arrows. Move does not count towards :(");if(n>p)return void console.error(this.name+" ("+this.race+") try to shoot on "+n+" meters, but can shoot only on "+p+". Move does not count towards :(");d.set(this,this.arrowCount-t);var o=this.arrowCount>0?"he can shoot still "+this.arrowCount+" arrows":"he can not shoot more!!!";console.info(this.name+" ("+this.race+") shot "+t+" arrows on "+n+" ("+o),e.updateHealth(-Math.floor(t*h+n*f))}},{key:"race",get:function(){return"elf"}},{key:"arrowCount",get:function(){return d.get(this)}}]),t}(c.default);t.default=w},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(1),c=o(s),l=3,h=110,f=new WeakMap,p=function(e){function t(e){r(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.health=80,n.power=30,n.damage=10,f.set(n,l),n}return i(t,e),u(t,[{key:"build",value:function(){if(0===this.buildCount)throw new Error(this.name+" ("+this.race+") can not build more");f.set(this,this.buildCount-1);var e=this.buildCount>0?"he can build still "+this.buildCount+" times":"he can not build more!!!";console.info(this.name+" ("+this.race+") built ("+e+")"),this.updateHealth()}},{key:"updateHealth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=this.health;this.health=Math.min(this.health+e,h),console.log(this.name+" ("+this.race+") new health = "+this.health+" ("+t+" + "+e+")")}},{key:"race",get:function(){return"human"}},{key:"buildCount",get:function(){return f.get(this)}}]),t}(c.default);t.default=p},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(1),c=o(s),l=5,h=.2,f=new WeakMap,p=function(e){function t(e){r(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.health=40,n.power=80,n.damage=130,f.set(n,l),n}return i(t,e),u(t,[{key:"attack",value:function(e){if(0===this.attackCount)throw new Error(this.name+" ("+this.race+") can not attack more");f.set(this,this.attackCount-1);var t=this.attackCount>0?"he can attack still "+this.attackCount+" times":"he can not attack more!!!";console.info(this.name+" ("+this.race+") attacked ("+t+")"),this.updatePower(),e.updateHealth(-Math.floor(this.power*h))}},{key:"updatePower",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=this.power;this.power+=e,console.info(this.name+" ("+this.race+") new power = "+this.power+" ("+t+" + "+e+")")}},{key:"race",get:function(){return"orc"}},{key:"attackCount",get:function(){return f.get(this)}}]),t}(c.default);t.default=p}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc2NyaXB0LmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCBhZTIzNzc4NzVmYTY1MjY0NjQzZiIsIndlYnBhY2s6Ly8vLi9zY3JpcHQuanMiLCJ3ZWJwYWNrOi8vLy4vY29tcG9uZW50cy9CYXNpY1JhY2UuanMiLCJ3ZWJwYWNrOi8vLy4vdXRpbHMuanMiLCJ3ZWJwYWNrOi8vLy4vY29tcG9uZW50cy9FbGYuanMiLCJ3ZWJwYWNrOi8vLy4vY29tcG9uZW50cy9IdW1hbi5qcyIsIndlYnBhY2s6Ly8vLi9jb21wb25lbnRzL09yYy5qcyJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpZCIsImxvYWRlZCIsImNhbGwiLCJtIiwiYyIsInAiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfSHVtYW4iLCJfSHVtYW4yIiwiX09yYyIsIl9PcmMyIiwiX0VsZiIsIl9FbGYyIiwiX3V0aWxzIiwidHVybk51bWJlciIsImNyZWF0ZUZpZ2h0ZXIiLCJyYWNlIiwibmFtZSIsImNvbnNvbGUiLCJlcnJvciIsIm1ha2VNb3ZlIiwiZmlnaHRlciIsImVuZW15IiwiYnVpbGQiLCJhdHRhY2siLCJzaG9vdCIsImdldFJhbmRvbVBhcmFtIiwiZ2V0V2lubmVyIiwiZmlnaHRlcjEiLCJmaWdodGVyMiIsImhlYWx0aCIsImJhdHRsZSIsImZpZ2h0ZXJSYWNlMSIsImZpZ2h0ZXJOYW1lMSIsImZpZ2h0ZXJSYWNlMiIsImZpZ2h0ZXJOYW1lMiIsIndhcm4iLCJlcnIiLCJtZXNzYWdlIiwid2lubmVySXMiLCJsb2ciLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ2YWx1ZSIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwicHJvdG90eXBlIiwiQmFzaWNSYWNlIiwidGhpcyIsInBvd2VyIiwiZGFtYWdlIiwid2Fsa2luZ1NwZWVkIiwicnVubmluZ1NwZWVkIiwiZGlzdGFuY2UiLCJ0aW1lIiwiZ2V0VGltZUJ5RGlzdGFuY2VBbmRTcGVlZCIsIm1pbiIsIm1heCIsInJlcyIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInNwZWVkIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJzZWxmIiwiUmVmZXJlbmNlRXJyb3IiLCJfaW5oZXJpdHMiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiX0Jhc2ljUmFjZTIiLCJfQmFzaWNSYWNlMyIsIk1BWF9BUlJPV1NfQ09VTlQiLCJIVU1BTl9IUF9ERUNSRUFTRV9GT1JfQVJST1ciLCJIVU1BTl9IUF9ERUNSRUFTRV9GT1JfVU5JVF9PRl9ESVNUQU5DRSIsIk1BWF9TSE9PVF9ESVNUQU5DRSIsImNvdW50TWFwIiwiV2Vha01hcCIsIkVsZiIsIl9CYXNpY1JhY2UiLCJfdGhpcyIsImdldFByb3RvdHlwZU9mIiwic2V0IiwiYXJyb3dzIiwiYXJyb3dDb3VudCIsIkVycm9yIiwiY2FuU3RpbGxTaG9vdEFycm93cyIsImluZm8iLCJ1cGRhdGVIZWFsdGgiLCJnZXQiLCJNQVhfQlVJTERfQ09VTlQiLCJNQVhfSEVBTFRIIiwiSHVtYW4iLCJidWlsZENvdW50IiwiY2FuU3RpbGxCdWlsbGQiLCJkZWx0YSIsImFyZ3VtZW50cyIsInVuZGVmaW5lZCIsInByZXZIZWFsdGgiLCJNQVhfQVRUQUNLUyIsIkhVTUFOX0hQX0RFQ1JFQVNFIiwiT3JjIiwiYXR0YWNrQ291bnQiLCJjYW5TdGlsbEF0dGFjayIsInVwZGF0ZVBvd2VyIiwicHJldlBvd2VyIl0sIm1hcHBpbmdzIjoiQ0FBUyxTQUFVQSxHQ0luQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQUUsT0FHQSxJQUFBQyxHQUFBRixFQUFBRCxJQUNBRSxXQUNBRSxHQUFBSixFQUNBSyxRQUFBLEVBVUEsT0FOQVAsR0FBQUUsR0FBQU0sS0FBQUgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUgsR0FHQUksRUFBQUUsUUFBQSxFQUdBRixFQUFBRCxRQXZCQSxHQUFBRCxLQXFDQSxPQVRBRixHQUFBUSxFQUFBVCxFQUdBQyxFQUFBUyxFQUFBUCxFQUdBRixFQUFBVSxFQUFBLEdBR0FWLEVBQUEsS0RNTSxTQUFTSSxFQUFRRCxFQUFTSCxHQUUvQixZQWdCQSxTQUFTVyxHQUF1QkMsR0FBTyxNQUFPQSxJQUFPQSxFQUFJQyxXQUFhRCxHQUFRRSxRQUFTRixHRTlEeEYsR0FBQUcsR0FBQWYsRUFBQSxHRmtES2dCLEVBQVVMLEVBQXVCSSxHRWpEdENFLEVBQUFqQixFQUFBLEdGcURLa0IsRUFBUVAsRUFBdUJNLEdFcERwQ0UsRUFBQW5CLEVBQUEsR0Z3REtvQixFQUFRVCxFQUF1QlEsR0V2RHBDRSxFQUFBckIsRUFBQSxHQU1Jc0IsU0FRRUMsRUFBZ0IsU0FBQ0MsRUFBTUMsR0FDM0IsT0FBUUQsR0FDTixJQUFLLFFBQ0gsTUFBTyxJQUFBUixHQUFBRixRQUFVVyxFQUNuQixLQUFLLE1BQ0gsTUFBTyxJQUFBUCxHQUFBSixRQUFRVyxFQUNqQixLQUFLLE1BQ0gsTUFBTyxJQUFBTCxHQUFBTixRQUFRVyxFQUNqQixTQUNFQyxRQUFRQyxNQUFSLHVEQUFxRUgsRUFBckUsT0FTQUksRUFBVyxTQUFDQyxFQUFTQyxHQUN6QixPQUFRRCxFQUFRTCxNQUNkLElBQUssUUFDSEssRUFBUUUsT0FDUixNQUNGLEtBQUssTUFDSEYsRUFBUUcsT0FBT0YsRUFDZixNQUNGLEtBQUssTUFDSEQsRUFBUUksTUFBTUgsR0FBTyxFQUFBVCxFQUFBYSxnQkFBZSxFQUFHLElBQUksRUFBQWIsRUFBQWEsZ0JBQWUsSUFBSyxHQUMvRCxNQUNGLFNBQ0VSLFFBQVFDLE1BQU0scUNBVWRRLEVBQVksU0FBQ0MsRUFBVUMsR0FBWCxNQUF5QkQsR0FBU0UsT0FBU0QsRUFBU0MsT0FBVUYsRUFBV0MsR0FTckZFLEVBQVMsU0FBQ0MsRUFBY0MsRUFBY0MsRUFBY0MsR0FDeERyQixFQUFhLEdBQ2IsSUFBTWMsR0FBV2IsRUFBY2lCLEVBQWNDLEdBQ3ZDSixFQUFXZCxFQUFjbUIsRUFBY0MsRUFFN0MsSUFBSVAsR0FBWUMsRUFDZCxHQUFJRCxFQUFTWixPQUFTYSxFQUFTYixLQUM3QixHQUF1QixVQUFsQlksRUFBU1osTUFBd0MsVUFBbEJhLEVBQVNiLEtBQzNDRSxRQUFRQyxNQUFSLGtCQUFnQ1MsRUFBU1osS0FBekMsUUFBcURhLEVBQVNiLEtBQTlELDJEQUdBLEtBREFFLFFBQVFrQixLQUFLLGtCQUNOdEIsRUFBYSxHQUNsQixJQUNNQSxFQUFhLEVBQ2ZNLEVBQVNTLEVBQVVELEdBRW5CUixFQUFTUSxFQUFVQyxHQUVyQmYsR0FBYyxFQUNkLE1BQU91QixHQUNQdkIsRUFBYSxFQUNiSSxRQUFRa0IsS0FBUixtQkFBZ0NDLEVBQUlDLFFBQ3BDLElBQU1DLEdBQVdaLEVBQVVFLEVBQVVELEVBQ3JDVixTQUFRa0IsS0FBUUcsRUFBU3RCLEtBQXpCLEtBQWtDc0IsRUFBU3ZCLEtBQTNDLDZCQUE0RXVCLEVBQVNULE9BQXJGLFVBS05aLFNBQVFDLE1BQU0seURBTXBCWSxHQUFPLE1BQU8sUUFBUyxRQUFTLE9BQ2hDYixRQUFRc0IsSUFBSSwrQ0FDWlQsRUFBTyxRQUFTLE9BQVEsTUFBTyxRQUMvQmIsUUFBUXNCLElBQUksK0NBQ1pULEVBQU8sTUFBTyxPQUFRLE1BQU8sU0FDN0JiLFFBQVFzQixJQUFJLCtDQUNaVCxFQUFPLFFBQVMsT0FBUSxRQUFTLFFBQ2pDYixRQUFRc0IsSUFBSSwrQ0FDWlQsRUFBTyxNQUFPLE9BQVEsUUFBUyxVRmlFekIsU0FBU25DLEVBQVFELEVBQVNILEdBRS9CLFlBVUEsU0FBU2lELEdBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBUmhIQyxPQUFPQyxlQUFlbkQsRUFBUyxjQUM3Qm9ELE9BQU8sR0FHVCxJQUFJQyxHQUFlLFdBQWMsUUFBU0MsR0FBaUJDLEVBQVFDLEdBQVMsSUFBSyxHQUFJQyxHQUFJLEVBQUdBLEVBQUlELEVBQU1FLE9BQVFELElBQUssQ0FBRSxHQUFJRSxHQUFhSCxFQUFNQyxFQUFJRSxHQUFXQyxXQUFhRCxFQUFXQyxhQUFjLEVBQU9ELEVBQVdFLGNBQWUsRUFBVSxTQUFXRixLQUFZQSxFQUFXRyxVQUFXLEdBQU1aLE9BQU9DLGVBQWVJLEVBQVFJLEVBQVdJLElBQUtKLElBQWlCLE1BQU8sVUFBVVgsRUFBYWdCLEVBQVlDLEdBQWlKLE1BQTlIRCxJQUFZVixFQUFpQk4sRUFBWWtCLFVBQVdGLEdBQWlCQyxHQUFhWCxFQUFpQk4sRUFBYWlCLEdBQXFCakIsTUdyTGppQjlCLEVBQUFyQixFQUFBLEdBRXFCc0UsRUh5TEosV0dsTGYsUUFBQUEsR0FBWTdDLEdBQU13QixFQUFBc0IsS0FBQUQsR0FBQUMsS0FObEJqQyxPQUFTLElBTVNpQyxLQUxsQkMsTUFBUSxHQUtVRCxLQUpsQkUsT0FBUyxHQUlTRixLQUhsQkcsYUFBZSxFQUdHSCxLQUZsQkksYUFBZSxHQUdiSixLQUFLOUMsS0FBT0EsRUg0TWIsTUFkQStCLEdBQWFjLElBQ1hKLElBQUssT0FDTFgsTUFBTyxTRzdMTHFCLEdBQ0gsR0FBTUMsSUFBTyxFQUFBeEQsRUFBQXlELDJCQUEwQkYsRUFBVUwsS0FBS0csYUFDdERoRCxTQUFRc0IsSUFBT3VCLEtBQUs5QyxLQUFwQixTQUFpQ21ELEVBQWpDLGlCQUEwREwsS0FBS0csYUFBL0QsZ0JBQTJGRyxFQUEzRixTSGdNQ1gsSUFBSyxNQUNMWCxNQUFPLFNHOUxOcUIsR0FDRixHQUFNQyxJQUFPLEVBQUF4RCxFQUFBeUQsMkJBQTBCRixFQUFVTCxLQUFLSSxhQUN0RGpELFNBQVFzQixJQUFPdUIsS0FBSzlDLEtBQXBCLFFBQWdDbUQsRUFBaEMsaUJBQXlETCxLQUFLSSxhQUE5RCxnQkFBMEZFLEVBQTFGLFVIa01NUCxJQUdUbkUsR0FBUVcsUUd2Tll3RCxHSDJOZixTQUFTbEUsRUFBUUQsR0FFdEIsWUFFQWtELFFBQU9DLGVBQWVuRCxFQUFTLGNBQzdCb0QsT0FBTyxHSTVOR3JCLGtCQUFpQixTQUFDNkMsRUFBS0MsR0FDbEMsR0FBSUMsU0FFSixHQUNFQSxHQUFNQyxLQUFLQyxNQUFPRCxLQUFLRSxVQUFZSixFQUFNRCxHQUFRQSxVQUN6Q0UsRUFDVixPQUFPQSxJQVNJSCw0QkFBNEIsU0FBQ0YsRUFBVVMsR0FBWCxNQUFxQkgsTUFBS0MsTUFBTVAsRUFBV1MsS0owTzlFLFNBQVNqRixFQUFRRCxFQUFTSCxHQUUvQixZQVlBLFNBQVNXLEdBQXVCQyxHQUFPLE1BQU9BLElBQU9BLEVBQUlDLFdBQWFELEdBQVFFLFFBQVNGLEdBRXZGLFFBQVNxQyxHQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQUVoSCxRQUFTa0MsR0FBMkJDLEVBQU1oRixHQUFRLElBQUtnRixFQUFRLEtBQU0sSUFBSUMsZ0JBQWUsNERBQWdFLFFBQU9qRixHQUF5QixnQkFBVEEsSUFBcUMsa0JBQVRBLEdBQThCZ0YsRUFBUGhGLEVBRWxPLFFBQVNrRixHQUFVQyxFQUFVQyxHQUFjLEdBQTBCLGtCQUFmQSxJQUE0QyxPQUFmQSxFQUF1QixLQUFNLElBQUl2QyxXQUFVLGlFQUFvRXVDLEdBQWVELEdBQVNyQixVQUFZaEIsT0FBT3VDLE9BQU9ELEdBQWNBLEVBQVd0QixXQUFhd0IsYUFBZXRDLE1BQU9tQyxFQUFVM0IsWUFBWSxFQUFPRSxVQUFVLEVBQU1ELGNBQWMsS0FBZTJCLElBQVl0QyxPQUFPeUMsZUFBaUJ6QyxPQUFPeUMsZUFBZUosRUFBVUMsR0FBY0QsRUFBU0ssVUFBWUosR0FoQmpldEMsT0FBT0MsZUFBZW5ELEVBQVMsY0FDN0JvRCxPQUFPLEdBR1QsSUFBSUMsR0FBZSxXQUFjLFFBQVNDLEdBQWlCQyxFQUFRQyxHQUFTLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsR0FBSUUsR0FBYUgsRUFBTUMsRUFBSUUsR0FBV0MsV0FBYUQsRUFBV0MsYUFBYyxFQUFPRCxFQUFXRSxjQUFlLEVBQVUsU0FBV0YsS0FBWUEsRUFBV0csVUFBVyxHQUFNWixPQUFPQyxlQUFlSSxFQUFRSSxFQUFXSSxJQUFLSixJQUFpQixNQUFPLFVBQVVYLEVBQWFnQixFQUFZQyxHQUFpSixNQUE5SEQsSUFBWVYsRUFBaUJOLEVBQVlrQixVQUFXRixHQUFpQkMsR0FBYVgsRUFBaUJOLEVBQWFpQixHQUFxQmpCLE1LdlFqaUI2QyxFQUFBaEcsRUFBQSxHTDJRS2lHLEVBQWN0RixFQUF1QnFGLEdLelFwQ0UsRUFBbUIsR0FDbkJDLEVBQThCLEVBQzlCQyxFQUF5QyxHQUN6Q0MsRUFBcUIsR0FFckJDLEVBQVcsR0FBSUMsU0FFQUMsRUxtUlYsU0FBVUMsR0s5UW5CLFFBQUFELEdBQVkvRSxHQUFNd0IsRUFBQXNCLEtBQUFpQyxFQUFBLElBQUFFLEdBQUFwQixFQUFBZixNQUFBaUMsRUFBQVQsV0FBQTFDLE9BQUFzRCxlQUFBSCxJQUFBakcsS0FBQWdFLEtBQ1Y5QyxHQURVLE9BQUFpRixHQUpsQnBFLE9BQVMsR0FJU29FLEVBSGxCbEMsTUFBUSxHQUdVa0MsRUFGbEJqQyxPQUFTLEdBSVA2QixFQUFTTSxJQUFURixFQUFtQlIsR0FGSFEsRUwyVGpCLE1BNUNBakIsR0FBVWUsRUFBS0MsR0FlZmpELEVBQWFnRCxJQUNYdEMsSUFBSyxRQUNMWCxNQUFPLFNLblJKekIsRUFBTytFLEVBQVFqQyxHQUNuQixHQUF3QixJQUFwQkwsS0FBS3VDLFdBQ1AsS0FBTSxJQUFJQyxPQUFTeEMsS0FBSzlDLEtBQWxCLEtBQTJCOEMsS0FBSy9DLEtBQWhDLHVCQUNELElBQUsrQyxLQUFLdUMsV0FBYUQsRUFBVSxFQUV0QyxXQURBbkYsU0FBUUMsTUFBUzRDLEtBQUs5QyxLQUF0QixLQUErQjhDLEtBQUsvQyxLQUFwQyxrQkFBMERxRixFQUExRCwrQkFBK0Z0QyxLQUFLdUMsV0FBcEcsMENBRUssSUFBSWxDLEVBQVd5QixFQUVwQixXQURBM0UsU0FBUUMsTUFBUzRDLEtBQUs5QyxLQUF0QixLQUErQjhDLEtBQUsvQyxLQUFwQyxxQkFBNkRvRCxFQUE3RCxrQ0FBdUd5QixFQUF2RyxtQ0FHRkMsR0FBU00sSUFBSXJDLEtBQU1BLEtBQUt1QyxXQUFhRCxFQUNyQyxJQUFNRyxHQUF1QnpDLEtBQUt1QyxXQUFhLEVBQW5CLHNCQUE4Q3ZDLEtBQUt1QyxXQUFuRCxVQUF5RSwwQkFDckdwRixTQUFRdUYsS0FBUTFDLEtBQUs5QyxLQUFyQixLQUE4QjhDLEtBQUsvQyxLQUFuQyxVQUFpRHFGLEVBQWpELGNBQXFFakMsRUFBckUsS0FBa0ZvQyxHQUNsRmxGLEVBQU1vRixjQUFlaEMsS0FBS0MsTUFBTzBCLEVBQVNWLEVBQWdDdkIsRUFBV3dCLE9Mc1JwRmxDLElBQUssT0FDTGlELElBQUssV0szU04sTUFBTyxTTCtTTmpELElBQUssYUFDTGlELElBQUssV0s1U04sTUFBT2IsR0FBU2EsSUFBSTVDLFVMaVRkaUMsR0FDUFAsRUFBWW5GLFFBRWRYLEdBQVFXLFFLblVZMEYsR0x1VWYsU0FBU3BHLEVBQVFELEVBQVNILEdBRS9CLFlBWUEsU0FBU1csR0FBdUJDLEdBQU8sTUFBT0EsSUFBT0EsRUFBSUMsV0FBYUQsR0FBUUUsUUFBU0YsR0FFdkYsUUFBU3FDLEdBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBRWhILFFBQVNrQyxHQUEyQkMsRUFBTWhGLEdBQVEsSUFBS2dGLEVBQVEsS0FBTSxJQUFJQyxnQkFBZSw0REFBZ0UsUUFBT2pGLEdBQXlCLGdCQUFUQSxJQUFxQyxrQkFBVEEsR0FBOEJnRixFQUFQaEYsRUFFbE8sUUFBU2tGLEdBQVVDLEVBQVVDLEdBQWMsR0FBMEIsa0JBQWZBLElBQTRDLE9BQWZBLEVBQXVCLEtBQU0sSUFBSXZDLFdBQVUsaUVBQW9FdUMsR0FBZUQsR0FBU3JCLFVBQVloQixPQUFPdUMsT0FBT0QsR0FBY0EsRUFBV3RCLFdBQWF3QixhQUFldEMsTUFBT21DLEVBQVUzQixZQUFZLEVBQU9FLFVBQVUsRUFBTUQsY0FBYyxLQUFlMkIsSUFBWXRDLE9BQU95QyxlQUFpQnpDLE9BQU95QyxlQUFlSixFQUFVQyxHQUFjRCxFQUFTSyxVQUFZSixHQWhCamV0QyxPQUFPQyxlQUFlbkQsRUFBUyxjQUM3Qm9ELE9BQU8sR0FHVCxJQUFJQyxHQUFlLFdBQWMsUUFBU0MsR0FBaUJDLEVBQVFDLEdBQVMsSUFBSyxHQUFJQyxHQUFJLEVBQUdBLEVBQUlELEVBQU1FLE9BQVFELElBQUssQ0FBRSxHQUFJRSxHQUFhSCxFQUFNQyxFQUFJRSxHQUFXQyxXQUFhRCxFQUFXQyxhQUFjLEVBQU9ELEVBQVdFLGNBQWUsRUFBVSxTQUFXRixLQUFZQSxFQUFXRyxVQUFXLEdBQU1aLE9BQU9DLGVBQWVJLEVBQVFJLEVBQVdJLElBQUtKLElBQWlCLE1BQU8sVUFBVVgsRUFBYWdCLEVBQVlDLEdBQWlKLE1BQTlIRCxJQUFZVixFQUFpQk4sRUFBWWtCLFVBQVdGLEdBQWlCQyxHQUFhWCxFQUFpQk4sRUFBYWlCLEdBQXFCakIsTU14VmppQjZDLEVBQUFoRyxFQUFBLEdONFZLaUcsRUFBY3RGLEVBQXVCcUYsR00xVnBDb0IsRUFBa0IsRUFDbEJDLEVBQWEsSUFFYmYsRUFBVyxHQUFJQyxTQUVBZSxFTm9XUixTQUFVYixHTS9WckIsUUFBQWEsR0FBWTdGLEdBQU13QixFQUFBc0IsS0FBQStDLEVBQUEsSUFBQVosR0FBQXBCLEVBQUFmLE1BQUErQyxFQUFBdkIsV0FBQTFDLE9BQUFzRCxlQUFBVyxJQUFBL0csS0FBQWdFLEtBQ1Y5QyxHQURVLE9BQUFpRixHQUpsQnBFLE9BQVMsR0FJU29FLEVBSGxCbEMsTUFBUSxHQUdVa0MsRUFGbEJqQyxPQUFTLEdBSVA2QixFQUFTTSxJQUFURixFQUFtQlUsR0FGSFYsRU4rWWpCLE1BL0NBakIsR0FBVTZCLEVBQU9iLEdBZWpCakQsRUFBYThELElBQ1hwRCxJQUFLLFFBQ0xYLE1BQU8sV01uV1IsR0FBd0IsSUFBcEJnQixLQUFLZ0QsV0FDUCxLQUFNLElBQUlSLE9BQVN4QyxLQUFLOUMsS0FBbEIsS0FBMkI4QyxLQUFLL0MsS0FBaEMsdUJBRVI4RSxHQUFTTSxJQUFJckMsS0FBTUEsS0FBS2dELFdBQWEsRUFDckMsSUFBTUMsR0FBa0JqRCxLQUFLZ0QsV0FBYSxFQUFuQixzQkFBOENoRCxLQUFLZ0QsV0FBbkQsU0FBd0UsMEJBQy9GN0YsU0FBUXVGLEtBQVExQyxLQUFLOUMsS0FBckIsS0FBOEI4QyxLQUFLL0MsS0FBbkMsWUFBbURnRyxFQUFuRCxLQUNBakQsS0FBSzJDLGtCTnVXSmhELElBQUssZUFDTFgsTUFBTyxXTXJXZSxHQUFaa0UsR0FBWUMsVUFBQTdELE9BQUEsR0FBQThELFNBQUFELFVBQUEsR0FBQUEsVUFBQSxHQUFKLEdBQ2JFLEVBQWFyRCxLQUFLakMsTUFDeEJpQyxNQUFLakMsT0FBUzRDLEtBQUtILElBQUtSLEtBQUtqQyxPQUFTbUYsRUFBUUosR0FDOUMzRixRQUFRc0IsSUFBT3VCLEtBQUs5QyxLQUFwQixLQUE2QjhDLEtBQUsvQyxLQUFsQyxrQkFBd0QrQyxLQUFLakMsT0FBN0QsS0FBd0VzRixFQUF4RSxNQUF3RkgsRUFBeEYsUU4wV0N2RCxJQUFLLE9BQ0xpRCxJQUFLLFdNL1hOLE1BQU8sV05tWU5qRCxJQUFLLGFBQ0xpRCxJQUFLLFdNaFlOLE1BQU9iLEdBQVNhLElBQUk1QyxVTnFZZCtDLEdBQ1ByQixFQUFZbkYsUUFFZFgsR0FBUVcsUU12Wll3RyxHTjJaZixTQUFTbEgsRUFBUUQsRUFBU0gsR0FFL0IsWUFZQSxTQUFTVyxHQUF1QkMsR0FBTyxNQUFPQSxJQUFPQSxFQUFJQyxXQUFhRCxHQUFRRSxRQUFTRixHQUV2RixRQUFTcUMsR0FBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FFaEgsUUFBU2tDLEdBQTJCQyxFQUFNaEYsR0FBUSxJQUFLZ0YsRUFBUSxLQUFNLElBQUlDLGdCQUFlLDREQUFnRSxRQUFPakYsR0FBeUIsZ0JBQVRBLElBQXFDLGtCQUFUQSxHQUE4QmdGLEVBQVBoRixFQUVsTyxRQUFTa0YsR0FBVUMsRUFBVUMsR0FBYyxHQUEwQixrQkFBZkEsSUFBNEMsT0FBZkEsRUFBdUIsS0FBTSxJQUFJdkMsV0FBVSxpRUFBb0V1QyxHQUFlRCxHQUFTckIsVUFBWWhCLE9BQU91QyxPQUFPRCxHQUFjQSxFQUFXdEIsV0FBYXdCLGFBQWV0QyxNQUFPbUMsRUFBVTNCLFlBQVksRUFBT0UsVUFBVSxFQUFNRCxjQUFjLEtBQWUyQixJQUFZdEMsT0FBT3lDLGVBQWlCekMsT0FBT3lDLGVBQWVKLEVBQVVDLEdBQWNELEVBQVNLLFVBQVlKLEdBaEJqZXRDLE9BQU9DLGVBQWVuRCxFQUFTLGNBQzdCb0QsT0FBTyxHQUdULElBQUlDLEdBQWUsV0FBYyxRQUFTQyxHQUFpQkMsRUFBUUMsR0FBUyxJQUFLLEdBQUlDLEdBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLEdBQUlFLEdBQWFILEVBQU1DLEVBQUlFLEdBQVdDLFdBQWFELEVBQVdDLGFBQWMsRUFBT0QsRUFBV0UsY0FBZSxFQUFVLFNBQVdGLEtBQVlBLEVBQVdHLFVBQVcsR0FBTVosT0FBT0MsZUFBZUksRUFBUUksRUFBV0ksSUFBS0osSUFBaUIsTUFBTyxVQUFVWCxFQUFhZ0IsRUFBWUMsR0FBaUosTUFBOUhELElBQVlWLEVBQWlCTixFQUFZa0IsVUFBV0YsR0FBaUJDLEdBQWFYLEVBQWlCTixFQUFhaUIsR0FBcUJqQixNTzFhamlCNkMsRUFBQWhHLEVBQUEsR1A4YUtpRyxFQUFjdEYsRUFBdUJxRixHTzVhcEM2QixFQUFjLEVBQ2RDLEVBQW9CLEdBRXBCeEIsRUFBVyxHQUFJQyxTQUVBd0IsRVBzYlYsU0FBVXRCLEdPamJuQixRQUFBc0IsR0FBWXRHLEdBQU13QixFQUFBc0IsS0FBQXdELEVBQUEsSUFBQXJCLEdBQUFwQixFQUFBZixNQUFBd0QsRUFBQWhDLFdBQUExQyxPQUFBc0QsZUFBQW9CLElBQUF4SCxLQUFBZ0UsS0FDVjlDLEdBRFUsT0FBQWlGLEdBSmxCcEUsT0FBUyxHQUlTb0UsRUFIbEJsQyxNQUFRLEdBR1VrQyxFQUZsQmpDLE9BQVMsSUFJUDZCLEVBQVNNLElBQVRGLEVBQW1CbUIsR0FGSG5CLEVQa2VqQixNQWhEQWpCLEdBQVVzQyxFQUFLdEIsR0FlZmpELEVBQWF1RSxJQUNYN0QsSUFBSyxTQUNMWCxNQUFPLFNPdGJIekIsR0FDTCxHQUF5QixJQUFyQnlDLEtBQUt5RCxZQUNQLEtBQU0sSUFBSWpCLE9BQVN4QyxLQUFLOUMsS0FBbEIsS0FBMkI4QyxLQUFLL0MsS0FBaEMsd0JBRVI4RSxHQUFTTSxJQUFJckMsS0FBTUEsS0FBS3lELFlBQWMsRUFDdEMsSUFBTUMsR0FBa0IxRCxLQUFLeUQsWUFBYyxFQUFwQix1QkFBZ0R6RCxLQUFLeUQsWUFBckQsU0FBMkUsMkJBQ2xHdEcsU0FBUXVGLEtBQVExQyxLQUFLOUMsS0FBckIsS0FBOEI4QyxLQUFLL0MsS0FBbkMsZUFBc0R5RyxFQUF0RCxLQUNBMUQsS0FBSzJELGNBQ0xwRyxFQUFNb0YsY0FBY2hDLEtBQUtDLE1BQU1aLEtBQUtDLE1BQVFzRCxPUHliM0M1RCxJQUFLLGNBQ0xYLE1BQU8sV092YmMsR0FBWmtFLEdBQVlDLFVBQUE3RCxPQUFBLEdBQUE4RCxTQUFBRCxVQUFBLEdBQUFBLFVBQUEsR0FBSixHQUNaUyxFQUFZNUQsS0FBS0MsS0FDdkJELE1BQUtDLE9BQVNpRCxFQUNkL0YsUUFBUXVGLEtBQVExQyxLQUFLOUMsS0FBckIsS0FBOEI4QyxLQUFLL0MsS0FBbkMsaUJBQXdEK0MsS0FBS0MsTUFBN0QsS0FBdUUyRCxFQUF2RSxNQUFzRlYsRUFBdEYsUVA0YkN2RCxJQUFLLE9BQ0xpRCxJQUFLLFdPbGROLE1BQU8sU1BzZE5qRCxJQUFLLGNBQ0xpRCxJQUFLLFdPbmROLE1BQU9iLEdBQVNhLElBQUk1QyxVUHdkZHdELEdBQ1A5QixFQUFZbkYsUUFFZFgsR0FBUVcsUU8xZVlpSCIsImZpbGUiOiJzY3JpcHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBfSHVtYW4gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuXHRcblx0dmFyIF9IdW1hbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9IdW1hbik7XG5cdFxuXHR2YXIgX09yYyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG5cdFxuXHR2YXIgX09yYzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9PcmMpO1xuXHRcblx0dmFyIF9FbGYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuXHRcblx0dmFyIF9FbGYyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRWxmKTtcblx0XG5cdHZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblx0XG5cdC8qKlxuXHQgKiDQndC+0LzQtdGAINGC0LXQutGD0YnQtdCz0L4g0YXQvtC00LBcblx0ICogQHR5cGUge051bWJlcn1cblx0ICovXG5cdHZhciB0dXJuTnVtYmVyID0gdm9pZCAwO1xuXHRcblx0LyoqXG5cdCAqINCh0L7Qt9C00LDQvdC40LUg0LHQvtC50YbQsFxuXHQgKiBAcGFyYW0gIHtTdHJpbmd9IHJhY2Ug0KLQuNC/INCx0L7QudGG0LAgKNC10LPQviDRgNCw0YHQsClcblx0ICogQHBhcmFtICB7U3RyaW5nfSBuYW1lINCY0LzRjyDQsdC+0LnRhtCwXG5cdCAqIEByZXR1cm4ge09iamVjdH1cblx0ICovXG5cdHZhciBjcmVhdGVGaWdodGVyID0gZnVuY3Rpb24gY3JlYXRlRmlnaHRlcihyYWNlLCBuYW1lKSB7XG5cdCAgc3dpdGNoIChyYWNlKSB7XG5cdCAgICBjYXNlICdodW1hbic6XG5cdCAgICAgIHJldHVybiBuZXcgX0h1bWFuMi5kZWZhdWx0KG5hbWUpO1xuXHQgICAgY2FzZSAnb3JjJzpcblx0ICAgICAgcmV0dXJuIG5ldyBfT3JjMi5kZWZhdWx0KG5hbWUpO1xuXHQgICAgY2FzZSAnZWxmJzpcblx0ICAgICAgcmV0dXJuIG5ldyBfRWxmMi5kZWZhdWx0KG5hbWUpO1xuXHQgICAgZGVmYXVsdDpcblx0ICAgICAgY29uc29sZS5lcnJvcignSXQgaXMgaW1wb3NzaWJsZSB0byBjcmVhdGUgYSBmaWdodGVyLiBVbmtub3duIHJhY2UgPCcgKyByYWNlICsgJz4nKTtcblx0ICB9XG5cdH07XG5cdFxuXHQvKipcblx0ICog0JTQtdC70LDQtdC8INGF0L7QtFxuXHQgKiBAcGFyYW0gIHtPYmplY3R9IGZpZ2h0ZXIg0JHQvtC10YYsINC60L7RgtC+0YDRi9C5INC00LXQu9Cw0LXRgiDRhdC+0LRcblx0ICogQHBhcmFtICB7T2JqZWN0fSBlbmVteSAgINCf0YDQvtGC0LjQstC90LjQuiwg0LrQvtGC0L7RgNGL0Lkg0L/RgNC+0YLQuNCy0L7RgdGC0L7QuNGCINCx0L7QudGG0YNcblx0ICovXG5cdHZhciBtYWtlTW92ZSA9IGZ1bmN0aW9uIG1ha2VNb3ZlKGZpZ2h0ZXIsIGVuZW15KSB7XG5cdCAgc3dpdGNoIChmaWdodGVyLnJhY2UpIHtcblx0ICAgIGNhc2UgJ2h1bWFuJzpcblx0ICAgICAgZmlnaHRlci5idWlsZCgpO1xuXHQgICAgICBicmVhaztcblx0ICAgIGNhc2UgJ29yYyc6XG5cdCAgICAgIGZpZ2h0ZXIuYXR0YWNrKGVuZW15KTtcblx0ICAgICAgYnJlYWs7XG5cdCAgICBjYXNlICdlbGYnOlxuXHQgICAgICBmaWdodGVyLnNob290KGVuZW15LCAoMCwgX3V0aWxzLmdldFJhbmRvbVBhcmFtKSg1LCAxKSwgKDAsIF91dGlscy5nZXRSYW5kb21QYXJhbSkoMTAwLCAxKSk7XG5cdCAgICAgIGJyZWFrO1xuXHQgICAgZGVmYXVsdDpcblx0ICAgICAgY29uc29sZS5lcnJvcignSXQgaXMgaW1wb3NzaWJsZSB0byBtYWtlIGEgbW92ZScpO1xuXHQgIH1cblx0fTtcblx0XG5cdC8qKlxuXHQgKiDQntC/0YDQtdC00LXQu9GP0LXQvCDQv9C+0LHQtdC00LjRgtC10LvRj1xuXHQgKiBAcGFyYW0gIHtPYmplY3R9IGZpZ2h0ZXIxIDEt0Lkg0LHQvtC10YZcblx0ICogQHBhcmFtICB7T2JqZWN0fSBmaWdodGVyMiAyLdC5INCx0L7QtdGGXG5cdCAqIEByZXR1cm4ge09iamVjdH0gICAgICAgICAg0J/QvtCx0LXQtNC40YLQtdC70Ywg0LHQvtGPXG5cdCAqL1xuXHR2YXIgZ2V0V2lubmVyID0gZnVuY3Rpb24gZ2V0V2lubmVyKGZpZ2h0ZXIxLCBmaWdodGVyMikge1xuXHQgIHJldHVybiBmaWdodGVyMS5oZWFsdGggPiBmaWdodGVyMi5oZWFsdGggPyBmaWdodGVyMSA6IGZpZ2h0ZXIyO1xuXHR9O1xuXHRcblx0LyoqXG5cdCAqINCX0LDQv9GD0YHQuiDQsdC+0Y9cblx0ICogQHBhcmFtICB7U3RyaW5nfSBmaWdodGVyUmFjZTEg0KLQuNC/IDEt0L7Qs9C+INCx0L7QudGG0LBcblx0ICogQHBhcmFtICB7U3RyaW5nfSBmaWdodGVyTmFtZTEg0JjQvNGPIDEt0L7Qs9C+INCx0L7QudGG0LBcblx0ICogQHBhcmFtICB7U3RyaW5nfSBmaWdodGVyUmFjZTIg0KLQuNC/IDIt0L7Qs9C+INCx0L7QudGG0LBcblx0ICogQHBhcmFtICB7U3RyaW5nfSBmaWdodGVyTmFtZTIg0JjQvNGPIDIt0L7Qs9C+INCx0L7QudGG0LBcblx0ICovXG5cdHZhciBiYXR0bGUgPSBmdW5jdGlvbiBiYXR0bGUoZmlnaHRlclJhY2UxLCBmaWdodGVyTmFtZTEsIGZpZ2h0ZXJSYWNlMiwgZmlnaHRlck5hbWUyKSB7XG5cdCAgdHVybk51bWJlciA9IDEwMDtcblx0ICB2YXIgZmlnaHRlcjEgPSBjcmVhdGVGaWdodGVyKGZpZ2h0ZXJSYWNlMSwgZmlnaHRlck5hbWUxKTtcblx0ICB2YXIgZmlnaHRlcjIgPSBjcmVhdGVGaWdodGVyKGZpZ2h0ZXJSYWNlMiwgZmlnaHRlck5hbWUyKTtcblx0XG5cdCAgaWYgKGZpZ2h0ZXIxICYmIGZpZ2h0ZXIyKSB7XG5cdCAgICBpZiAoZmlnaHRlcjEucmFjZSAhPT0gZmlnaHRlcjIucmFjZSkge1xuXHQgICAgICBpZiAoZmlnaHRlcjEucmFjZSAhPT0gJ2h1bWFuJyAmJiBmaWdodGVyMi5yYWNlICE9PSAnaHVtYW4nKSB7XG5cdCAgICAgICAgY29uc29sZS5lcnJvcignQmF0dGxlIGJldHdlZW4gJyArIGZpZ2h0ZXIxLnJhY2UgKyAnIGFuZCAnICsgZmlnaHRlcjIucmFjZSArICcgaXMgaW1wb3NzaWJsZS4gT25lIG9mIHRoZSBmaWdodGVycyBtdXN0IGJlIGEgaHVtYW4nKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBjb25zb2xlLndhcm4oJ0JhdHRsZSBzdGFydGVkJyk7XG5cdCAgICAgICAgd2hpbGUgKHR1cm5OdW1iZXIgPiAwKSB7XG5cdCAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICBpZiAodHVybk51bWJlciAlIDIpIHtcblx0ICAgICAgICAgICAgICBtYWtlTW92ZShmaWdodGVyMiwgZmlnaHRlcjEpO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIG1ha2VNb3ZlKGZpZ2h0ZXIxLCBmaWdodGVyMik7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgdHVybk51bWJlciAtPSAxO1xuXHQgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG5cdCAgICAgICAgICAgIHR1cm5OdW1iZXIgPSAwO1xuXHQgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0JhdHRsZSBzdG9wcGVkLiAnICsgZXJyLm1lc3NhZ2UpO1xuXHQgICAgICAgICAgICB2YXIgd2lubmVySXMgPSBnZXRXaW5uZXIoZmlnaHRlcjIsIGZpZ2h0ZXIxKTtcblx0ICAgICAgICAgICAgY29uc29sZS53YXJuKHdpbm5lcklzLm5hbWUgKyAnICgnICsgd2lubmVySXMucmFjZSArICcpIGlzIHdpbm5lciAoaGlzIGhlYWx0aCA9ICcgKyB3aW5uZXJJcy5oZWFsdGggKyAnKSEnKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGNvbnNvbGUuZXJyb3IoJ0JhdHRsZSBiZXR3ZWVuIHR3byBmaWdodGVycyBvZiBvbmUgcmFjZSBpcyBpbXBvc3NpYmxlJyk7XG5cdCAgICB9XG5cdCAgfVxuXHR9O1xuXHRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblx0YmF0dGxlKCdlbGYnLCAnQXJnb24nLCAnaHVtYW4nLCAnQm9iJyk7XG5cdGNvbnNvbGUubG9nKCcqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqJyk7XG5cdGJhdHRsZSgnaHVtYW4nLCAnQm9ueScsICdvcmMnLCAnQm9sZycpO1xuXHRjb25zb2xlLmxvZygnKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKicpO1xuXHRiYXR0bGUoJ29yYycsICdCb2xnJywgJ2VsZicsICdBcmdvbicpOyAvLyBCYXR0bGUgYmV0d2VlbiBvcmMgYW5kIGVsZiBpcyBpbXBvc3NpYmxlLiBPbmUgb2YgdGhlIGZpZ2h0ZXJzIG11c3QgYmUgYSBodW1hblxuXHRjb25zb2xlLmxvZygnKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKicpO1xuXHRiYXR0bGUoJ2h1bWFuJywgJ0FsZXgnLCAnaHVtYW4nLCAnTmljaycpOyAvLyBCYXR0bGUgYmV0d2VlbiB0d28gZmlnaHRlcnMgb2Ygb25lIHJhY2UgaXMgaW1wb3NzaWJsZVxuXHRjb25zb2xlLmxvZygnKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKicpO1xuXHRiYXR0bGUoJ29yYycsICdCb2xnJywgJ25pbmphJywgJ0thdHR5Jyk7IC8vIEl0IGlzIGltcG9zc2libGUgdG8gY3JlYXRlIGEgZmlnaHRlci4gVW5rbm93biByYWNlIDxuaW5qYT5cblxuLyoqKi8gfSxcbi8qIDEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfdXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdHZhciBCYXNpY1JhY2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgZnVuY3Rpb24gQmFzaWNSYWNlKG5hbWUpIHtcblx0ICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYXNpY1JhY2UpO1xuXHRcblx0ICAgIHRoaXMuaGVhbHRoID0gMTAwO1xuXHQgICAgdGhpcy5wb3dlciA9IDUwO1xuXHQgICAgdGhpcy5kYW1hZ2UgPSAxNTtcblx0ICAgIHRoaXMud2Fsa2luZ1NwZWVkID0gNTtcblx0ICAgIHRoaXMucnVubmluZ1NwZWVkID0gMTU7XG5cdFxuXHQgICAgdGhpcy5uYW1lID0gbmFtZTtcblx0ICB9XG5cdFxuXHQgIF9jcmVhdGVDbGFzcyhCYXNpY1JhY2UsIFt7XG5cdCAgICBrZXk6ICd3YWxrJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiB3YWxrKGRpc3RhbmNlKSB7XG5cdCAgICAgIHZhciB0aW1lID0gKDAsIF91dGlscy5nZXRUaW1lQnlEaXN0YW5jZUFuZFNwZWVkKShkaXN0YW5jZSwgdGhpcy53YWxraW5nU3BlZWQpO1xuXHQgICAgICBjb25zb2xlLmxvZyh0aGlzLm5hbWUgKyAnIHdhbGsgJyArIGRpc3RhbmNlICsgJ2ttIHdpdGggc3BlZWQgJyArIHRoaXMud2Fsa2luZ1NwZWVkICsgJ2ttL2ggKHRpbWUgLSAnICsgdGltZSArICdoKScpO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ3J1bicsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gcnVuKGRpc3RhbmNlKSB7XG5cdCAgICAgIHZhciB0aW1lID0gKDAsIF91dGlscy5nZXRUaW1lQnlEaXN0YW5jZUFuZFNwZWVkKShkaXN0YW5jZSwgdGhpcy5ydW5uaW5nU3BlZWQpO1xuXHQgICAgICBjb25zb2xlLmxvZyh0aGlzLm5hbWUgKyAnIHJ1biAnICsgZGlzdGFuY2UgKyAna20gd2l0aCBzcGVlZCAnICsgdGhpcy5ydW5uaW5nU3BlZWQgKyAna20vaCAodGltZSAtICcgKyB0aW1lICsgJ2gpJyk7XG5cdCAgICB9XG5cdCAgfV0pO1xuXHRcblx0ICByZXR1cm4gQmFzaWNSYWNlO1xuXHR9KCk7XG5cdFxuXHRleHBvcnRzLmRlZmF1bHQgPSBCYXNpY1JhY2U7XG5cbi8qKiovIH0sXG4vKiAyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHQvKipcblx0ICog0J/QvtC70YPRh9C10L3QuNC1INGB0LvRg9GH0LDQudC90L7Qs9C+INGG0LXQu9C+0LPQviDQvdC10YDQsNCy0L3QvtC80LXRgNC90L4g0YDQsNGB0L/RgNC10LTQtdC70LXQvdC90L7Qs9C+INGH0LjRgdC70LAg0LzQtdC20LTRgyBtaW4gKNCy0LrQu9GO0YfQuNGC0LXQu9GM0L3Qvikg0LggbWF4ICjQvdC1INCy0LrQu9GO0YfQsNGPIG1heClcblx0ICogQHBhcmFtICB7TnVtYmVyfSBtaW4g0JzQuNC90LjQvNCw0LvRjNC90L7QtSDQt9C90LDRh9C10L3QuNC1INC/0LDRgNCw0LzQtdGC0YDQsFxuXHQgKiBAcGFyYW0gIHtOdW1iZXJ9IG1heCDQnNCw0LrRgdC40LzQsNC70YzQvdC+0LUg0LfQvdCw0YfQtdC90LjQtSDQv9Cw0YDQsNC80LXRgtGA0LBcblx0ICogQHJldHVybiB7TnVtYmVyfVxuXHQgKi9cblx0dmFyIGdldFJhbmRvbVBhcmFtID0gZXhwb3J0cy5nZXRSYW5kb21QYXJhbSA9IGZ1bmN0aW9uIGdldFJhbmRvbVBhcmFtKG1pbiwgbWF4KSB7XG5cdCAgdmFyIHJlcyA9IHZvaWQgMDtcblx0ICAvLyDQptC40LrQuyBkbyB3aGlsZSDQuNGB0LrQu9GO0YfQsNC10YIg0L/QvtC70YPRh9C10L3QuNC1INC90YPQu9GPXG5cdCAgZG8ge1xuXHQgICAgcmVzID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbikgKyBtaW4pO1xuXHQgIH0gd2hpbGUgKCFyZXMpO1xuXHQgIHJldHVybiByZXM7XG5cdH07XG5cdFxuXHQvKipcblx0ICog0JLRi9GH0LjRgdC70LXQvdC40LUg0LLRgNC10LzQtdC90Lgg0L/RgNC+0YXQvtC20LTQtdC90LjRjyDQvdC10LrQvtGC0L7RgNC+0Lkg0LTQuNGB0YLQsNC90YbQuNC4INGBINC30LDQtNCw0L3QvdC+0Lkg0YHQutC+0YDQvtGB0YLRjNGOXG5cdCAqIEBwYXJhbSAge051bWJlcn0gZGlzdGFuY2Ug0JTQuNGB0YLQsNC90YbQuNGPXG5cdCAqIEBwYXJhbSAge051bWJlcn0gc3BlZWQgICAg0KHQutC+0YDQvtGB0YLRjFxuXHQgKiBAcmV0dXJuIHtOdW1iZXJ9ICAgICAgICAgINCS0YDQtdC80Y9cblx0ICovXG5cdHZhciBnZXRUaW1lQnlEaXN0YW5jZUFuZFNwZWVkID0gZXhwb3J0cy5nZXRUaW1lQnlEaXN0YW5jZUFuZFNwZWVkID0gZnVuY3Rpb24gZ2V0VGltZUJ5RGlzdGFuY2VBbmRTcGVlZChkaXN0YW5jZSwgc3BlZWQpIHtcblx0ICByZXR1cm4gTWF0aC5mbG9vcihkaXN0YW5jZSAvIHNwZWVkKTtcblx0fTtcblxuLyoqKi8gfSxcbi8qIDMgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfQmFzaWNSYWNlMiA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX0Jhc2ljUmFjZTMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9CYXNpY1JhY2UyKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cdFxuXHRmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBNQVhfQVJST1dTX0NPVU5UID0gMTA7XG5cdHZhciBIVU1BTl9IUF9ERUNSRUFTRV9GT1JfQVJST1cgPSA1O1xuXHR2YXIgSFVNQU5fSFBfREVDUkVBU0VfRk9SX1VOSVRfT0ZfRElTVEFOQ0UgPSAwLjE7XG5cdHZhciBNQVhfU0hPT1RfRElTVEFOQ0UgPSA5MDtcblx0XG5cdHZhciBjb3VudE1hcCA9IG5ldyBXZWFrTWFwKCk7XG5cdFxuXHR2YXIgRWxmID0gZnVuY3Rpb24gKF9CYXNpY1JhY2UpIHtcblx0ICBfaW5oZXJpdHMoRWxmLCBfQmFzaWNSYWNlKTtcblx0XG5cdCAgZnVuY3Rpb24gRWxmKG5hbWUpIHtcblx0ICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFbGYpO1xuXHRcblx0ICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChFbGYuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihFbGYpKS5jYWxsKHRoaXMsIG5hbWUpKTtcblx0XG5cdCAgICBfdGhpcy5oZWFsdGggPSA3MDtcblx0ICAgIF90aGlzLnBvd2VyID0gMjA7XG5cdCAgICBfdGhpcy5kYW1hZ2UgPSA0MDtcblx0XG5cdCAgICBjb3VudE1hcC5zZXQoX3RoaXMsIE1BWF9BUlJPV1NfQ09VTlQpO1xuXHQgICAgcmV0dXJuIF90aGlzO1xuXHQgIH1cblx0XG5cdCAgX2NyZWF0ZUNsYXNzKEVsZiwgW3tcblx0ICAgIGtleTogJ3Nob290Jyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBzaG9vdChlbmVteSwgYXJyb3dzLCBkaXN0YW5jZSkge1xuXHQgICAgICBpZiAodGhpcy5hcnJvd0NvdW50ID09PSAwKSB7XG5cdCAgICAgICAgdGhyb3cgbmV3IEVycm9yKHRoaXMubmFtZSArICcgKCcgKyB0aGlzLnJhY2UgKyAnKSBjYW4gbm90IHNob290IG1vcmUnKTtcblx0ICAgICAgfSBlbHNlIGlmICh0aGlzLmFycm93Q291bnQgLSBhcnJvd3MgPCAwKSB7XG5cdCAgICAgICAgY29uc29sZS5lcnJvcih0aGlzLm5hbWUgKyAnICgnICsgdGhpcy5yYWNlICsgJykgdHJ5IHRvIHNob290ICcgKyBhcnJvd3MgKyAnIGFycm93cywgYnV0IGNhbiBzaG9vdCBvbmx5ICcgKyB0aGlzLmFycm93Q291bnQgKyAnIGFycm93cy4gTW92ZSBkb2VzIG5vdCBjb3VudCB0b3dhcmRzIDooJyk7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgICB9IGVsc2UgaWYgKGRpc3RhbmNlID4gTUFYX1NIT09UX0RJU1RBTkNFKSB7XG5cdCAgICAgICAgY29uc29sZS5lcnJvcih0aGlzLm5hbWUgKyAnICgnICsgdGhpcy5yYWNlICsgJykgdHJ5IHRvIHNob290IG9uICcgKyBkaXN0YW5jZSArICcgbWV0ZXJzLCBidXQgY2FuIHNob290IG9ubHkgb24gJyArIE1BWF9TSE9PVF9ESVNUQU5DRSArICcuIE1vdmUgZG9lcyBub3QgY291bnQgdG93YXJkcyA6KCcpO1xuXHQgICAgICAgIHJldHVybjtcblx0ICAgICAgfVxuXHQgICAgICBjb3VudE1hcC5zZXQodGhpcywgdGhpcy5hcnJvd0NvdW50IC0gYXJyb3dzKTtcblx0ICAgICAgdmFyIGNhblN0aWxsU2hvb3RBcnJvd3MgPSB0aGlzLmFycm93Q291bnQgPiAwID8gJ2hlIGNhbiBzaG9vdCBzdGlsbCAnICsgdGhpcy5hcnJvd0NvdW50ICsgJyBhcnJvd3MnIDogJ2hlIGNhbiBub3Qgc2hvb3QgbW9yZSEhISc7XG5cdCAgICAgIGNvbnNvbGUuaW5mbyh0aGlzLm5hbWUgKyAnICgnICsgdGhpcy5yYWNlICsgJykgc2hvdCAnICsgYXJyb3dzICsgJyBhcnJvd3Mgb24gJyArIGRpc3RhbmNlICsgJyAoJyArIGNhblN0aWxsU2hvb3RBcnJvd3MpO1xuXHQgICAgICBlbmVteS51cGRhdGVIZWFsdGgoLU1hdGguZmxvb3IoYXJyb3dzICogSFVNQU5fSFBfREVDUkVBU0VfRk9SX0FSUk9XICsgZGlzdGFuY2UgKiBIVU1BTl9IUF9ERUNSRUFTRV9GT1JfVU5JVF9PRl9ESVNUQU5DRSkpO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ3JhY2UnLFxuXHQgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG5cdCAgICAgIHJldHVybiAnZWxmJztcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6ICdhcnJvd0NvdW50Jyxcblx0ICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHQgICAgICByZXR1cm4gY291bnRNYXAuZ2V0KHRoaXMpO1xuXHQgICAgfVxuXHQgIH1dKTtcblx0XG5cdCAgcmV0dXJuIEVsZjtcblx0fShfQmFzaWNSYWNlMy5kZWZhdWx0KTtcblx0XG5cdGV4cG9ydHMuZGVmYXVsdCA9IEVsZjtcblxuLyoqKi8gfSxcbi8qIDQgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfQmFzaWNSYWNlMiA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX0Jhc2ljUmFjZTMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9CYXNpY1JhY2UyKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cdFxuXHRmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBNQVhfQlVJTERfQ09VTlQgPSAzO1xuXHR2YXIgTUFYX0hFQUxUSCA9IDExMDtcblx0XG5cdHZhciBjb3VudE1hcCA9IG5ldyBXZWFrTWFwKCk7XG5cdFxuXHR2YXIgSHVtYW4gPSBmdW5jdGlvbiAoX0Jhc2ljUmFjZSkge1xuXHQgIF9pbmhlcml0cyhIdW1hbiwgX0Jhc2ljUmFjZSk7XG5cdFxuXHQgIGZ1bmN0aW9uIEh1bWFuKG5hbWUpIHtcblx0ICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBIdW1hbik7XG5cdFxuXHQgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKEh1bWFuLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoSHVtYW4pKS5jYWxsKHRoaXMsIG5hbWUpKTtcblx0XG5cdCAgICBfdGhpcy5oZWFsdGggPSA4MDtcblx0ICAgIF90aGlzLnBvd2VyID0gMzA7XG5cdCAgICBfdGhpcy5kYW1hZ2UgPSAxMDtcblx0XG5cdCAgICBjb3VudE1hcC5zZXQoX3RoaXMsIE1BWF9CVUlMRF9DT1VOVCk7XG5cdCAgICByZXR1cm4gX3RoaXM7XG5cdCAgfVxuXHRcblx0ICBfY3JlYXRlQ2xhc3MoSHVtYW4sIFt7XG5cdCAgICBrZXk6ICdidWlsZCcsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGQoKSB7XG5cdCAgICAgIGlmICh0aGlzLmJ1aWxkQ291bnQgPT09IDApIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IodGhpcy5uYW1lICsgJyAoJyArIHRoaXMucmFjZSArICcpIGNhbiBub3QgYnVpbGQgbW9yZScpO1xuXHQgICAgICB9XG5cdCAgICAgIGNvdW50TWFwLnNldCh0aGlzLCB0aGlzLmJ1aWxkQ291bnQgLSAxKTtcblx0ICAgICAgdmFyIGNhblN0aWxsQnVpbGxkID0gdGhpcy5idWlsZENvdW50ID4gMCA/ICdoZSBjYW4gYnVpbGQgc3RpbGwgJyArIHRoaXMuYnVpbGRDb3VudCArICcgdGltZXMnIDogJ2hlIGNhbiBub3QgYnVpbGQgbW9yZSEhISc7XG5cdCAgICAgIGNvbnNvbGUuaW5mbyh0aGlzLm5hbWUgKyAnICgnICsgdGhpcy5yYWNlICsgJykgYnVpbHQgKCcgKyBjYW5TdGlsbEJ1aWxsZCArICcpJyk7XG5cdCAgICAgIHRoaXMudXBkYXRlSGVhbHRoKCk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiAndXBkYXRlSGVhbHRoJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVIZWFsdGgoKSB7XG5cdCAgICAgIHZhciBkZWx0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogMTA7XG5cdFxuXHQgICAgICB2YXIgcHJldkhlYWx0aCA9IHRoaXMuaGVhbHRoO1xuXHQgICAgICB0aGlzLmhlYWx0aCA9IE1hdGgubWluKHRoaXMuaGVhbHRoICsgZGVsdGEsIE1BWF9IRUFMVEgpO1xuXHQgICAgICBjb25zb2xlLmxvZyh0aGlzLm5hbWUgKyAnICgnICsgdGhpcy5yYWNlICsgJykgbmV3IGhlYWx0aCA9ICcgKyB0aGlzLmhlYWx0aCArICcgKCcgKyBwcmV2SGVhbHRoICsgJyArICcgKyBkZWx0YSArICcpJyk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiAncmFjZScsXG5cdCAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0ICAgICAgcmV0dXJuICdodW1hbic7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiAnYnVpbGRDb3VudCcsXG5cdCAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0ICAgICAgcmV0dXJuIGNvdW50TWFwLmdldCh0aGlzKTtcblx0ICAgIH1cblx0ICB9XSk7XG5cdFxuXHQgIHJldHVybiBIdW1hbjtcblx0fShfQmFzaWNSYWNlMy5kZWZhdWx0KTtcblx0XG5cdGV4cG9ydHMuZGVmYXVsdCA9IEh1bWFuO1xuXG4vKioqLyB9LFxuLyogNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXHRcblx0dmFyIF9CYXNpY1JhY2UyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfQmFzaWNSYWNlMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0Jhc2ljUmFjZTIpO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXHRcblx0dmFyIE1BWF9BVFRBQ0tTID0gNTtcblx0dmFyIEhVTUFOX0hQX0RFQ1JFQVNFID0gMC4yO1xuXHRcblx0dmFyIGNvdW50TWFwID0gbmV3IFdlYWtNYXAoKTtcblx0XG5cdHZhciBPcmMgPSBmdW5jdGlvbiAoX0Jhc2ljUmFjZSkge1xuXHQgIF9pbmhlcml0cyhPcmMsIF9CYXNpY1JhY2UpO1xuXHRcblx0ICBmdW5jdGlvbiBPcmMobmFtZSkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE9yYyk7XG5cdFxuXHQgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKE9yYy5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE9yYykpLmNhbGwodGhpcywgbmFtZSkpO1xuXHRcblx0ICAgIF90aGlzLmhlYWx0aCA9IDQwO1xuXHQgICAgX3RoaXMucG93ZXIgPSA4MDtcblx0ICAgIF90aGlzLmRhbWFnZSA9IDEzMDtcblx0XG5cdCAgICBjb3VudE1hcC5zZXQoX3RoaXMsIE1BWF9BVFRBQ0tTKTtcblx0ICAgIHJldHVybiBfdGhpcztcblx0ICB9XG5cdFxuXHQgIF9jcmVhdGVDbGFzcyhPcmMsIFt7XG5cdCAgICBrZXk6ICdhdHRhY2snLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGF0dGFjayhlbmVteSkge1xuXHQgICAgICBpZiAodGhpcy5hdHRhY2tDb3VudCA9PT0gMCkge1xuXHQgICAgICAgIHRocm93IG5ldyBFcnJvcih0aGlzLm5hbWUgKyAnICgnICsgdGhpcy5yYWNlICsgJykgY2FuIG5vdCBhdHRhY2sgbW9yZScpO1xuXHQgICAgICB9XG5cdCAgICAgIGNvdW50TWFwLnNldCh0aGlzLCB0aGlzLmF0dGFja0NvdW50IC0gMSk7XG5cdCAgICAgIHZhciBjYW5TdGlsbEF0dGFjayA9IHRoaXMuYXR0YWNrQ291bnQgPiAwID8gJ2hlIGNhbiBhdHRhY2sgc3RpbGwgJyArIHRoaXMuYXR0YWNrQ291bnQgKyAnIHRpbWVzJyA6ICdoZSBjYW4gbm90IGF0dGFjayBtb3JlISEhJztcblx0ICAgICAgY29uc29sZS5pbmZvKHRoaXMubmFtZSArICcgKCcgKyB0aGlzLnJhY2UgKyAnKSBhdHRhY2tlZCAoJyArIGNhblN0aWxsQXR0YWNrICsgJyknKTtcblx0ICAgICAgdGhpcy51cGRhdGVQb3dlcigpO1xuXHQgICAgICBlbmVteS51cGRhdGVIZWFsdGgoLU1hdGguZmxvb3IodGhpcy5wb3dlciAqIEhVTUFOX0hQX0RFQ1JFQVNFKSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiAndXBkYXRlUG93ZXInLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZVBvd2VyKCkge1xuXHQgICAgICB2YXIgZGVsdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IDEwO1xuXHRcblx0ICAgICAgdmFyIHByZXZQb3dlciA9IHRoaXMucG93ZXI7XG5cdCAgICAgIHRoaXMucG93ZXIgKz0gZGVsdGE7XG5cdCAgICAgIGNvbnNvbGUuaW5mbyh0aGlzLm5hbWUgKyAnICgnICsgdGhpcy5yYWNlICsgJykgbmV3IHBvd2VyID0gJyArIHRoaXMucG93ZXIgKyAnICgnICsgcHJldlBvd2VyICsgJyArICcgKyBkZWx0YSArICcpJyk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiAncmFjZScsXG5cdCAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0ICAgICAgcmV0dXJuICdvcmMnO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2F0dGFja0NvdW50Jyxcblx0ICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHQgICAgICByZXR1cm4gY291bnRNYXAuZ2V0KHRoaXMpO1xuXHQgICAgfVxuXHQgIH1dKTtcblx0XG5cdCAgcmV0dXJuIE9yYztcblx0fShfQmFzaWNSYWNlMy5kZWZhdWx0KTtcblx0XG5cdGV4cG9ydHMuZGVmYXVsdCA9IE9yYztcblxuLyoqKi8gfVxuLyoqKioqKi8gXSk7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNjcmlwdC5qcyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIGFlMjM3Nzg3NWZhNjUyNjQ2NDNmIiwiaW1wb3J0IEh1bWFuIGZyb20gJy4vY29tcG9uZW50cy9IdW1hbic7XG5pbXBvcnQgT3JjIGZyb20gJy4vY29tcG9uZW50cy9PcmMnO1xuaW1wb3J0IEVsZiBmcm9tICcuL2NvbXBvbmVudHMvRWxmJztcbmltcG9ydCB7IGdldFJhbmRvbVBhcmFtIH0gZnJvbSAnLi91dGlscyc7XG5cbi8qKlxuICog0J3QvtC80LXRgCDRgtC10LrRg9GJ0LXQs9C+INGF0L7QtNCwXG4gKiBAdHlwZSB7TnVtYmVyfVxuICovXG5sZXQgdHVybk51bWJlcjtcblxuLyoqXG4gKiDQodC+0LfQtNCw0L3QuNC1INCx0L7QudGG0LBcbiAqIEBwYXJhbSAge1N0cmluZ30gcmFjZSDQotC40L8g0LHQvtC50YbQsCAo0LXQs9C+INGA0LDRgdCwKVxuICogQHBhcmFtICB7U3RyaW5nfSBuYW1lINCY0LzRjyDQsdC+0LnRhtCwXG4gKiBAcmV0dXJuIHtPYmplY3R9XG4gKi9cbmNvbnN0IGNyZWF0ZUZpZ2h0ZXIgPSAocmFjZSwgbmFtZSkgPT4ge1xuICBzd2l0Y2ggKHJhY2UpIHtcbiAgICBjYXNlICdodW1hbic6XG4gICAgICByZXR1cm4gbmV3IEh1bWFuKG5hbWUpO1xuICAgIGNhc2UgJ29yYyc6XG4gICAgICByZXR1cm4gbmV3IE9yYyhuYW1lKTtcbiAgICBjYXNlICdlbGYnOlxuICAgICAgcmV0dXJuIG5ldyBFbGYobmFtZSk7XG4gICAgZGVmYXVsdDpcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEl0IGlzIGltcG9zc2libGUgdG8gY3JlYXRlIGEgZmlnaHRlci4gVW5rbm93biByYWNlIDwke3JhY2V9PmApO1xuICB9XG59O1xuXG4vKipcbiAqINCU0LXQu9Cw0LXQvCDRhdC+0LRcbiAqIEBwYXJhbSAge09iamVjdH0gZmlnaHRlciDQkdC+0LXRhiwg0LrQvtGC0L7RgNGL0Lkg0LTQtdC70LDQtdGCINGF0L7QtFxuICogQHBhcmFtICB7T2JqZWN0fSBlbmVteSAgINCf0YDQvtGC0LjQstC90LjQuiwg0LrQvtGC0L7RgNGL0Lkg0L/RgNC+0YLQuNCy0L7RgdGC0L7QuNGCINCx0L7QudGG0YNcbiAqL1xuY29uc3QgbWFrZU1vdmUgPSAoZmlnaHRlciwgZW5lbXkpID0+IHtcbiAgc3dpdGNoIChmaWdodGVyLnJhY2UpIHtcbiAgICBjYXNlICdodW1hbic6XG4gICAgICBmaWdodGVyLmJ1aWxkKCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdvcmMnOlxuICAgICAgZmlnaHRlci5hdHRhY2soZW5lbXkpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnZWxmJzpcbiAgICAgIGZpZ2h0ZXIuc2hvb3QoZW5lbXksIGdldFJhbmRvbVBhcmFtKDUsIDEpLCBnZXRSYW5kb21QYXJhbSgxMDAsIDEpKTtcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICBjb25zb2xlLmVycm9yKCdJdCBpcyBpbXBvc3NpYmxlIHRvIG1ha2UgYSBtb3ZlJyk7XG4gIH1cbn07XG5cbi8qKlxuICog0J7Qv9GA0LXQtNC10LvRj9C10Lwg0L/QvtCx0LXQtNC40YLQtdC70Y9cbiAqIEBwYXJhbSAge09iamVjdH0gZmlnaHRlcjEgMS3QuSDQsdC+0LXRhlxuICogQHBhcmFtICB7T2JqZWN0fSBmaWdodGVyMiAyLdC5INCx0L7QtdGGXG4gKiBAcmV0dXJuIHtPYmplY3R9ICAgICAgICAgINCf0L7QsdC10LTQuNGC0LXQu9GMINCx0L7Rj1xuICovXG5jb25zdCBnZXRXaW5uZXIgPSAoZmlnaHRlcjEsIGZpZ2h0ZXIyKSA9PiAoZmlnaHRlcjEuaGVhbHRoID4gZmlnaHRlcjIuaGVhbHRoKSA/IGZpZ2h0ZXIxIDogZmlnaHRlcjI7XG5cbi8qKlxuICog0JfQsNC/0YPRgdC6INCx0L7Rj1xuICogQHBhcmFtICB7U3RyaW5nfSBmaWdodGVyUmFjZTEg0KLQuNC/IDEt0L7Qs9C+INCx0L7QudGG0LBcbiAqIEBwYXJhbSAge1N0cmluZ30gZmlnaHRlck5hbWUxINCY0LzRjyAxLdC+0LPQviDQsdC+0LnRhtCwXG4gKiBAcGFyYW0gIHtTdHJpbmd9IGZpZ2h0ZXJSYWNlMiDQotC40L8gMi3QvtCz0L4g0LHQvtC50YbQsFxuICogQHBhcmFtICB7U3RyaW5nfSBmaWdodGVyTmFtZTIg0JjQvNGPIDIt0L7Qs9C+INCx0L7QudGG0LBcbiAqL1xuY29uc3QgYmF0dGxlID0gKGZpZ2h0ZXJSYWNlMSwgZmlnaHRlck5hbWUxLCBmaWdodGVyUmFjZTIsIGZpZ2h0ZXJOYW1lMikgPT4ge1xuICB0dXJuTnVtYmVyID0gMTAwO1xuICBjb25zdCBmaWdodGVyMSA9IGNyZWF0ZUZpZ2h0ZXIoZmlnaHRlclJhY2UxLCBmaWdodGVyTmFtZTEpO1xuICBjb25zdCBmaWdodGVyMiA9IGNyZWF0ZUZpZ2h0ZXIoZmlnaHRlclJhY2UyLCBmaWdodGVyTmFtZTIpO1xuXG4gIGlmIChmaWdodGVyMSAmJiBmaWdodGVyMikge1xuICAgIGlmIChmaWdodGVyMS5yYWNlICE9PSBmaWdodGVyMi5yYWNlKSB7XG4gICAgICBpZiAoKGZpZ2h0ZXIxLnJhY2UgIT09ICdodW1hbicpICYmIChmaWdodGVyMi5yYWNlICE9PSAnaHVtYW4nKSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBCYXR0bGUgYmV0d2VlbiAke2ZpZ2h0ZXIxLnJhY2V9IGFuZCAke2ZpZ2h0ZXIyLnJhY2V9IGlzIGltcG9zc2libGUuIE9uZSBvZiB0aGUgZmlnaHRlcnMgbXVzdCBiZSBhIGh1bWFuYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLndhcm4oJ0JhdHRsZSBzdGFydGVkJyk7XG4gICAgICAgIHdoaWxlICh0dXJuTnVtYmVyID4gMCkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodHVybk51bWJlciAlIDIpIHtcbiAgICAgICAgICAgICAgbWFrZU1vdmUoZmlnaHRlcjIsIGZpZ2h0ZXIxKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG1ha2VNb3ZlKGZpZ2h0ZXIxLCBmaWdodGVyMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0dXJuTnVtYmVyIC09IDE7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICB0dXJuTnVtYmVyID0gMDtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgQmF0dGxlIHN0b3BwZWQuICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICBjb25zdCB3aW5uZXJJcyA9IGdldFdpbm5lcihmaWdodGVyMiwgZmlnaHRlcjEpO1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGAke3dpbm5lcklzLm5hbWV9ICgke3dpbm5lcklzLnJhY2V9KSBpcyB3aW5uZXIgKGhpcyBoZWFsdGggPSAke3dpbm5lcklzLmhlYWx0aH0pIWApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdCYXR0bGUgYmV0d2VlbiB0d28gZmlnaHRlcnMgb2Ygb25lIHJhY2UgaXMgaW1wb3NzaWJsZScpO1xuICAgIH1cbiAgfVxufTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmJhdHRsZSgnZWxmJywgJ0FyZ29uJywgJ2h1bWFuJywgJ0JvYicpO1xuY29uc29sZS5sb2coJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKionKTtcbmJhdHRsZSgnaHVtYW4nLCAnQm9ueScsICdvcmMnLCAnQm9sZycpO1xuY29uc29sZS5sb2coJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKionKTtcbmJhdHRsZSgnb3JjJywgJ0JvbGcnLCAnZWxmJywgJ0FyZ29uJyk7ICAgICAvLyBCYXR0bGUgYmV0d2VlbiBvcmMgYW5kIGVsZiBpcyBpbXBvc3NpYmxlLiBPbmUgb2YgdGhlIGZpZ2h0ZXJzIG11c3QgYmUgYSBodW1hblxuY29uc29sZS5sb2coJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKionKTtcbmJhdHRsZSgnaHVtYW4nLCAnQWxleCcsICdodW1hbicsICdOaWNrJyk7ICAvLyBCYXR0bGUgYmV0d2VlbiB0d28gZmlnaHRlcnMgb2Ygb25lIHJhY2UgaXMgaW1wb3NzaWJsZVxuY29uc29sZS5sb2coJyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKionKTtcbmJhdHRsZSgnb3JjJywgJ0JvbGcnLCAnbmluamEnLCAnS2F0dHknKTsgICAvLyBJdCBpcyBpbXBvc3NpYmxlIHRvIGNyZWF0ZSBhIGZpZ2h0ZXIuIFVua25vd24gcmFjZSA8bmluamE+XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zY3JpcHQuanMiLCJpbXBvcnQgeyBnZXRUaW1lQnlEaXN0YW5jZUFuZFNwZWVkIH0gZnJvbSAnLi4vdXRpbHMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCYXNpY1JhY2Uge1xuICBoZWFsdGggPSAxMDA7XG4gIHBvd2VyID0gNTA7XG4gIGRhbWFnZSA9IDE1O1xuICB3YWxraW5nU3BlZWQgPSA1O1xuICBydW5uaW5nU3BlZWQgPSAxNTtcblxuICBjb25zdHJ1Y3RvcihuYW1lKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgfVxuXG4gIHdhbGsoZGlzdGFuY2UpIHtcbiAgICBjb25zdCB0aW1lID0gZ2V0VGltZUJ5RGlzdGFuY2VBbmRTcGVlZChkaXN0YW5jZSwgdGhpcy53YWxraW5nU3BlZWQpO1xuICAgIGNvbnNvbGUubG9nKGAke3RoaXMubmFtZX0gd2FsayAke2Rpc3RhbmNlfWttIHdpdGggc3BlZWQgJHt0aGlzLndhbGtpbmdTcGVlZH1rbS9oICh0aW1lIC0gJHt0aW1lfWgpYCk7XG4gIH1cblxuICBydW4oZGlzdGFuY2UpIHtcbiAgICBjb25zdCB0aW1lID0gZ2V0VGltZUJ5RGlzdGFuY2VBbmRTcGVlZChkaXN0YW5jZSwgdGhpcy5ydW5uaW5nU3BlZWQpO1xuICAgIGNvbnNvbGUubG9nKGAke3RoaXMubmFtZX0gcnVuICR7ZGlzdGFuY2V9a20gd2l0aCBzcGVlZCAke3RoaXMucnVubmluZ1NwZWVkfWttL2ggKHRpbWUgLSAke3RpbWV9aClgKTtcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vY29tcG9uZW50cy9CYXNpY1JhY2UuanMiLCIvKipcbiAqINCf0L7Qu9GD0YfQtdC90LjQtSDRgdC70YPRh9Cw0LnQvdC+0LPQviDRhtC10LvQvtCz0L4g0L3QtdGA0LDQstC90L7QvNC10YDQvdC+INGA0LDRgdC/0YDQtdC00LXQu9C10L3QvdC+0LPQviDRh9C40YHQu9CwINC80LXQttC00YMgbWluICjQstC60LvRjtGH0LjRgtC10LvRjNC90L4pINC4IG1heCAo0L3QtSDQstC60LvRjtGH0LDRjyBtYXgpXG4gKiBAcGFyYW0gIHtOdW1iZXJ9IG1pbiDQnNC40L3QuNC80LDQu9GM0L3QvtC1INC30L3QsNGH0LXQvdC40LUg0L/QsNGA0LDQvNC10YLRgNCwXG4gKiBAcGFyYW0gIHtOdW1iZXJ9IG1heCDQnNCw0LrRgdC40LzQsNC70YzQvdC+0LUg0LfQvdCw0YfQtdC90LjQtSDQv9Cw0YDQsNC80LXRgtGA0LBcbiAqIEByZXR1cm4ge051bWJlcn1cbiAqL1xuZXhwb3J0IGNvbnN0IGdldFJhbmRvbVBhcmFtID0gKG1pbiwgbWF4KSA9PiB7XG4gIGxldCByZXM7XG4gIC8vINCm0LjQutC7IGRvIHdoaWxlINC40YHQutC70Y7Rh9Cw0LXRgiDQv9C+0LvRg9GH0LXQvdC40LUg0L3Rg9C70Y9cbiAgZG8ge1xuICAgIHJlcyA9IE1hdGguZmxvb3IoKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSkgKyBtaW4pO1xuICB9IHdoaWxlICghcmVzKTtcbiAgcmV0dXJuIHJlcztcbn07XG5cbi8qKlxuICog0JLRi9GH0LjRgdC70LXQvdC40LUg0LLRgNC10LzQtdC90Lgg0L/RgNC+0YXQvtC20LTQtdC90LjRjyDQvdC10LrQvtGC0L7RgNC+0Lkg0LTQuNGB0YLQsNC90YbQuNC4INGBINC30LDQtNCw0L3QvdC+0Lkg0YHQutC+0YDQvtGB0YLRjNGOXG4gKiBAcGFyYW0gIHtOdW1iZXJ9IGRpc3RhbmNlINCU0LjRgdGC0LDQvdGG0LjRj1xuICogQHBhcmFtICB7TnVtYmVyfSBzcGVlZCAgICDQodC60L7RgNC+0YHRgtGMXG4gKiBAcmV0dXJuIHtOdW1iZXJ9ICAgICAgICAgINCS0YDQtdC80Y9cbiAqL1xuZXhwb3J0IGNvbnN0IGdldFRpbWVCeURpc3RhbmNlQW5kU3BlZWQgPSAoZGlzdGFuY2UsIHNwZWVkKSA9PiBNYXRoLmZsb29yKGRpc3RhbmNlIC8gc3BlZWQpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vdXRpbHMuanMiLCJpbXBvcnQgQmFzaWNSYWNlIGZyb20gJy4vQmFzaWNSYWNlJztcblxuY29uc3QgTUFYX0FSUk9XU19DT1VOVCA9IDEwO1xuY29uc3QgSFVNQU5fSFBfREVDUkVBU0VfRk9SX0FSUk9XID0gNTtcbmNvbnN0IEhVTUFOX0hQX0RFQ1JFQVNFX0ZPUl9VTklUX09GX0RJU1RBTkNFID0gMC4xO1xuY29uc3QgTUFYX1NIT09UX0RJU1RBTkNFID0gOTA7XG5cbmNvbnN0IGNvdW50TWFwID0gbmV3IFdlYWtNYXAoKTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRWxmIGV4dGVuZHMgQmFzaWNSYWNlIHtcbiAgaGVhbHRoID0gNzA7XG4gIHBvd2VyID0gMjA7XG4gIGRhbWFnZSA9IDQwO1xuXG4gIGNvbnN0cnVjdG9yKG5hbWUpIHtcbiAgICBzdXBlcihuYW1lKTtcbiAgICBjb3VudE1hcC5zZXQodGhpcywgTUFYX0FSUk9XU19DT1VOVCk7XG4gIH1cblxuICBnZXQgcmFjZSgpIHtcbiAgICByZXR1cm4gJ2VsZic7XG4gIH1cblxuICBnZXQgYXJyb3dDb3VudCgpIHtcbiAgICByZXR1cm4gY291bnRNYXAuZ2V0KHRoaXMpO1xuICB9XG5cbiAgc2hvb3QoZW5lbXksIGFycm93cywgZGlzdGFuY2UpIHtcbiAgICBpZiAodGhpcy5hcnJvd0NvdW50ID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dGhpcy5uYW1lfSAoJHt0aGlzLnJhY2V9KSBjYW4gbm90IHNob290IG1vcmVgKTtcbiAgICB9IGVsc2UgaWYgKCh0aGlzLmFycm93Q291bnQgLSBhcnJvd3MpIDwgMCkge1xuICAgICAgY29uc29sZS5lcnJvcihgJHt0aGlzLm5hbWV9ICgke3RoaXMucmFjZX0pIHRyeSB0byBzaG9vdCAke2Fycm93c30gYXJyb3dzLCBidXQgY2FuIHNob290IG9ubHkgJHt0aGlzLmFycm93Q291bnR9IGFycm93cy4gTW92ZSBkb2VzIG5vdCBjb3VudCB0b3dhcmRzIDooYCk7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmIChkaXN0YW5jZSA+IE1BWF9TSE9PVF9ESVNUQU5DRSkge1xuICAgICAgY29uc29sZS5lcnJvcihgJHt0aGlzLm5hbWV9ICgke3RoaXMucmFjZX0pIHRyeSB0byBzaG9vdCBvbiAke2Rpc3RhbmNlfSBtZXRlcnMsIGJ1dCBjYW4gc2hvb3Qgb25seSBvbiAke01BWF9TSE9PVF9ESVNUQU5DRX0uIE1vdmUgZG9lcyBub3QgY291bnQgdG93YXJkcyA6KGApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb3VudE1hcC5zZXQodGhpcywgdGhpcy5hcnJvd0NvdW50IC0gYXJyb3dzKTtcbiAgICBjb25zdCBjYW5TdGlsbFNob290QXJyb3dzID0gKHRoaXMuYXJyb3dDb3VudCA+IDApID8gYGhlIGNhbiBzaG9vdCBzdGlsbCAke3RoaXMuYXJyb3dDb3VudH0gYXJyb3dzYCA6ICdoZSBjYW4gbm90IHNob290IG1vcmUhISEnO1xuICAgIGNvbnNvbGUuaW5mbyhgJHt0aGlzLm5hbWV9ICgke3RoaXMucmFjZX0pIHNob3QgJHthcnJvd3N9IGFycm93cyBvbiAke2Rpc3RhbmNlfSAoJHtjYW5TdGlsbFNob290QXJyb3dzfWApO1xuICAgIGVuZW15LnVwZGF0ZUhlYWx0aCgtKE1hdGguZmxvb3IoKGFycm93cyAqIEhVTUFOX0hQX0RFQ1JFQVNFX0ZPUl9BUlJPVykgKyAoZGlzdGFuY2UgKiBIVU1BTl9IUF9ERUNSRUFTRV9GT1JfVU5JVF9PRl9ESVNUQU5DRSkpKSk7XG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL2NvbXBvbmVudHMvRWxmLmpzIiwiaW1wb3J0IEJhc2ljUmFjZSBmcm9tICcuL0Jhc2ljUmFjZSc7XG5cbmNvbnN0IE1BWF9CVUlMRF9DT1VOVCA9IDM7XG5jb25zdCBNQVhfSEVBTFRIID0gMTEwO1xuXG5jb25zdCBjb3VudE1hcCA9IG5ldyBXZWFrTWFwKCk7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEh1bWFuIGV4dGVuZHMgQmFzaWNSYWNlIHtcbiAgaGVhbHRoID0gODA7XG4gIHBvd2VyID0gMzA7XG4gIGRhbWFnZSA9IDEwO1xuXG4gIGNvbnN0cnVjdG9yKG5hbWUpIHtcbiAgICBzdXBlcihuYW1lKTtcbiAgICBjb3VudE1hcC5zZXQodGhpcywgTUFYX0JVSUxEX0NPVU5UKTtcbiAgfVxuXG4gIGdldCByYWNlKCkge1xuICAgIHJldHVybiAnaHVtYW4nO1xuICB9XG5cbiAgZ2V0IGJ1aWxkQ291bnQoKSB7XG4gICAgcmV0dXJuIGNvdW50TWFwLmdldCh0aGlzKTtcbiAgfVxuXG4gIGJ1aWxkKCkge1xuICAgIGlmICh0aGlzLmJ1aWxkQ291bnQgPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgJHt0aGlzLm5hbWV9ICgke3RoaXMucmFjZX0pIGNhbiBub3QgYnVpbGQgbW9yZWApO1xuICAgIH1cbiAgICBjb3VudE1hcC5zZXQodGhpcywgdGhpcy5idWlsZENvdW50IC0gMSk7XG4gICAgY29uc3QgY2FuU3RpbGxCdWlsbGQgPSAodGhpcy5idWlsZENvdW50ID4gMCkgPyBgaGUgY2FuIGJ1aWxkIHN0aWxsICR7dGhpcy5idWlsZENvdW50fSB0aW1lc2AgOiAnaGUgY2FuIG5vdCBidWlsZCBtb3JlISEhJztcbiAgICBjb25zb2xlLmluZm8oYCR7dGhpcy5uYW1lfSAoJHt0aGlzLnJhY2V9KSBidWlsdCAoJHtjYW5TdGlsbEJ1aWxsZH0pYCk7XG4gICAgdGhpcy51cGRhdGVIZWFsdGgoKTtcbiAgfVxuXG4gIHVwZGF0ZUhlYWx0aChkZWx0YSA9IDEwKSB7XG4gICAgY29uc3QgcHJldkhlYWx0aCA9IHRoaXMuaGVhbHRoO1xuICAgIHRoaXMuaGVhbHRoID0gTWF0aC5taW4oKHRoaXMuaGVhbHRoICsgZGVsdGEpLCBNQVhfSEVBTFRIKTtcbiAgICBjb25zb2xlLmxvZyhgJHt0aGlzLm5hbWV9ICgke3RoaXMucmFjZX0pIG5ldyBoZWFsdGggPSAke3RoaXMuaGVhbHRofSAoJHtwcmV2SGVhbHRofSArICR7ZGVsdGF9KWApO1xuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9jb21wb25lbnRzL0h1bWFuLmpzIiwiaW1wb3J0IEJhc2ljUmFjZSBmcm9tICcuL0Jhc2ljUmFjZSc7XG5cbmNvbnN0IE1BWF9BVFRBQ0tTID0gNTtcbmNvbnN0IEhVTUFOX0hQX0RFQ1JFQVNFID0gMC4yO1xuXG5jb25zdCBjb3VudE1hcCA9IG5ldyBXZWFrTWFwKCk7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9yYyBleHRlbmRzIEJhc2ljUmFjZSB7XG4gIGhlYWx0aCA9IDQwO1xuICBwb3dlciA9IDgwO1xuICBkYW1hZ2UgPSAxMzA7XG5cbiAgY29uc3RydWN0b3IobmFtZSkge1xuICAgIHN1cGVyKG5hbWUpO1xuICAgIGNvdW50TWFwLnNldCh0aGlzLCBNQVhfQVRUQUNLUyk7XG4gIH1cblxuICBnZXQgcmFjZSgpIHtcbiAgICByZXR1cm4gJ29yYyc7XG4gIH1cblxuICBnZXQgYXR0YWNrQ291bnQoKSB7XG4gICAgcmV0dXJuIGNvdW50TWFwLmdldCh0aGlzKTtcbiAgfVxuXG4gIGF0dGFjayhlbmVteSkge1xuICAgIGlmICh0aGlzLmF0dGFja0NvdW50ID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dGhpcy5uYW1lfSAoJHt0aGlzLnJhY2V9KSBjYW4gbm90IGF0dGFjayBtb3JlYCk7XG4gICAgfVxuICAgIGNvdW50TWFwLnNldCh0aGlzLCB0aGlzLmF0dGFja0NvdW50IC0gMSk7XG4gICAgY29uc3QgY2FuU3RpbGxBdHRhY2sgPSAodGhpcy5hdHRhY2tDb3VudCA+IDApID8gYGhlIGNhbiBhdHRhY2sgc3RpbGwgJHt0aGlzLmF0dGFja0NvdW50fSB0aW1lc2AgOiAnaGUgY2FuIG5vdCBhdHRhY2sgbW9yZSEhISc7XG4gICAgY29uc29sZS5pbmZvKGAke3RoaXMubmFtZX0gKCR7dGhpcy5yYWNlfSkgYXR0YWNrZWQgKCR7Y2FuU3RpbGxBdHRhY2t9KWApO1xuICAgIHRoaXMudXBkYXRlUG93ZXIoKTtcbiAgICBlbmVteS51cGRhdGVIZWFsdGgoLU1hdGguZmxvb3IodGhpcy5wb3dlciAqIEhVTUFOX0hQX0RFQ1JFQVNFKSk7XG4gIH1cblxuICB1cGRhdGVQb3dlcihkZWx0YSA9IDEwKSB7XG4gICAgY29uc3QgcHJldlBvd2VyID0gdGhpcy5wb3dlcjtcbiAgICB0aGlzLnBvd2VyICs9IGRlbHRhO1xuICAgIGNvbnNvbGUuaW5mbyhgJHt0aGlzLm5hbWV9ICgke3RoaXMucmFjZX0pIG5ldyBwb3dlciA9ICR7dGhpcy5wb3dlcn0gKCR7cHJldlBvd2VyfSArICR7ZGVsdGF9KWApO1xuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9jb21wb25lbnRzL09yYy5qcyJdLCJzb3VyY2VSb290IjoiIn0=